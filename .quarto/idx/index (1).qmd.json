{"title":"CARREGAMENTO DE PACOTES","markdown":{"yaml":{"project":{"type":"website","output-dir":"docs"},"execute":{"cache":true,"freeze":"auto","warning":false},"website":{"title":"Projeto Final","favicon":"logo3.png","navbar":{"pinned":true,"logo":"logo2.gif","left":[{"href":"resumo.qmd","text":"Sobre o projeto"},{"text":"Análise dos Dados","menu":[{"href":"dados.qmd","text":"Análise Contagem de Galhas (Escala de Notas)"},{"href":"dados2.qmd","text":"Análise Fator de Reprodução"}]}],"right":[{"icon":"linkedin","href":"https://br.linkedin.com/in/dy%C3%AAnici-rodrigues-30ba6a241"},{"icon":"instagram","menu":[{"text":"Dyênici Rodrigues","url":"https://www.instagram.com/dyenici/"},{"text":"Emerson M. Del Ponte","url":"https://www.instagram.com/emdelponte/"},{"text":"Fitopatolofia UFV","url":"https://www.instagram.com/fitopatologiaufv/"}]},{"icon":"youtube","href":"https://www.youtube.com/edelponte"},{"icon":"github","menu":[{"text":"Dyênici Rodrigues","url":"https://github.com/dyenici"},{"text":"Emerson M. Del Ponte","url":"https://github.com/emdelponte"}]}]}},"format":{"html":{"theme":{"light":"flatly","dark":"darkly"},"css":"styles.css","toc":true}},"editor":"visual"},"headingText":"CARREGAMENTO DE PACOTES","containsRefs":false,"markdown":"\n\n\n```{r}\n\nlibrary(tidyverse)\nlibrary(drc)\nlibrary(gsheet)\nlibrary(kableExtra)\nlibrary(DT)\nlibrary(leaflet)\nlibrary(patchwork)\nlibrary(performance)\nlibrary(emmeans)\nlibrary(DHARMa)\nlibrary(multcomp)\nlibrary(epifitter)\nlibrary(lme4)\nlibrary(agricolae)\nlibrary(qqplotr)\n```\n\n## LOCALIZAÇÃO DOS EXPERIMENTOS\n\n### Os experimentos foram conduzidos na área experimental do Departamento de Fitopatologia da Universidade Federal de Viçosa, município de Viçosa, Minas Gerais, Brasil, localizada na região sudeste do estado de Minas Gerais (20º44'44''S, 42º50'59''O e 661 m acima do nível do mar). O primeiro experimento foi conduzido de novembro de 2023 a março de 2024 (Experimento 1; E1) e o segundo experimento de dezembro de 2023 a abril de 2024 (Experimento 2; E2).\n\n```{r}\nleaflet() %>%\n  addTiles() %>% \n  setView(lng = -42.8497, lat = -20.7453, zoom = 16) %>% \n  addMarkers(lng = -42.8497, lat = -20.7453, \n             popup = \"Localização do experimento\")\n```\n\n## ANÁLISE DE GERMINAÇÃO DE UREDÓSPOROS (GU)\n\n### A germinação de uredósporos (*GU*) é um bioensaio crítico para avaliar a sensibilidade de patógenos a tratamentos. Nesta seção, modelamos a curva dose-resposta usando um modelo log-logístico, calculamos a inibição percentual em relação ao controle e determinamos a EC50 (dose para 50% de inibição). Os resultados são apresentados em gráficos com intervalos de confiança e tabelas sumarizadas, destacando a eficácia do tratamento em suprimir a germinação.\n\n```{r}\nGU <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1zEsVt_nnmydEUBJjkyMrOLHEu6pXeM-SmwTXyEoNbmg/edit?gid=0#gid=0\")\n\nGU <- GU %>% \n  mutate(\n    REPETICAO = as.factor(REPETICAO),\n    DOSE = as.numeric(DOSE)\n  )\n\nhead(GU) %>% \n  kable(align = \"c\") %>% \n  kable_styling(full_width = FALSE)\n\ncontrole <- GU %>% \n  filter(DOSE == 0) %>% \n  summarise(mean_controle = mean(TAXA_DE_GERMINAÇÃO)) %>% \n  pull()\n\nGU2 <- GU %>% \n  group_by(DOSE) %>%\n  summarise(\n    mean_germ = mean(TAXA_DE_GERMINAÇÃO),\n    sd_germ = sd(TAXA_DE_GERMINAÇÃO),\n    n = n()\n  ) %>% \n  mutate(\n    inib = ((controle - mean_germ)/controle)*100,\n    CI_lower = mean_germ - qt(0.975, df = n-1) * sd_germ/sqrt(n),\n    CI_upper = mean_germ + qt(0.975, df = n-1) * sd_germ/sqrt(n)\n  ) %>% \n  round(digits = 2)\n\nhead(GU2) %>% \n  kable(align = \"c\") %>% \n  kable_styling(full_width = FALSE)\n```\n\n## MODELAGEM DA CURVA DOSE-RESPOSTA\n\nA modelagem da curva dose-resposta é essencial para quantificar a relação entre a concentração do tratamento e seu efeito na germinação de uredósporos. Nesta análise:\n\nUtilizamos um modelo não linear (*drm* com função *W1.4*) para estimar parâmetros como:\n\n-   **E\\<sub\\>max\\</sub\\>**: Máxima inibição observada.\n\n-   **EC50**: Dose para 50% do efeito (com IC 95%).\n\n-   **Inclinação da curva**: Sensibilidade do patógeno a variações de dose.\\\n    A validação do modelo incluiu análise de resíduos e teste de normalidade, garantindo robustez nas estimativas.\n\n```{r}\nEC <- drm(\n  mean_germ ~ DOSE,\n  data = GU2,\n  fct = W1.4()\n)\n\nsummary(EC)\n\npar(mfrow = c(1, 2))\nplot(residuals(EC) ~ fitted(EC), main = \"Resíduos vs Ajustados\")\nabline(h = 0, col = \"red\")\nqqnorm(residuals(EC), main = \"Q-Q Plot dos Resíduos\")\nqqline(residuals(EC), col = \"red\")\n\nEC50_result <- ED(EC, 50, interval = \"delta\")\ncat(paste(\"EC50 =\", round(EC50_result[1], 2),\n          \"(\", round(EC50_result[3], 2), \"-\", round(EC50_result[4], 2), \")\"))\n```\n\n## VISUALIZAÇÃO DA CURVA DOSE-RESPOSTA\n\n```{r}\nplot_curva <- ggplot(data = GU2, aes(x = DOSE)) +\n  geom_point(aes(y = mean_germ), size = 3) +\n  geom_errorbar(aes(ymin = CI_lower, ymax = CI_upper), width = 0.2) +\n  geom_line(aes(y = fitted(EC)), color = \"blue\") +\n  geom_hline(yintercept = 50, linetype = \"dashed\", color = \"red\") +\n  annotate(\"text\", \n           x = max(GU2$DOSE), \n           y = 55,\n           label = paste0(\"EC50 = \", round(EC50_result[1], 2), \n                          \" (\", round(EC50_result[3], 2), \"-\", \n                          round(EC50_result[4], 2), \")\"), \n           hjust = 1, \n           color = \"red\") +\n  labs(x = expression(\"Dose (ml L\"^-1~\")\"), \n       y = \"Germinação média (%)\",\n       title = \"Curva Dose-Resposta\") +\n  theme_minimal()\n\nprint(plot_curva)\n\n```\n\n## CÁLCULO DA ÁREA ABAIXO DA CURVA (AACPD)\n\n```{r}\nPTD <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1zEsVt_nnmydEUBJjkyMrOLHEu6pXeM-SmwTXyEoNbmg/edit?gid=1680501439#gid=1680501439\")\n\nPTD <- PTD %>% \n  mutate(\n    SEVERIDADE = as.numeric(str_replace(SEVERIDADE, \",\", \".\")) / 100,\n    REPETIÇÃO = as.factor(REPETIÇÃO),\n    BLOCO = as.factor(BLOCO),\n    TRATAMENTO = as.factor(TRATAMENTO)\n  )\n\nniveis_tratamento <- c(\"Control\", \"3 x F\", \"3 x IRStimulus\",\n                       \"F, IRStimulus, IRStimulus\", \n                       \"IRStimulus, F, IRStimulus\", \n                       \"IRStimulus+F, F,F\")\n\nlevels(PTD$TRATAMENTO) <- niveis_tratamento\n\nPTD_2 <- PTD %>%\n  group_by(REPETIÇÃO, TRATAMENTO, DAE) %>% \n  summarise(\n    sev_mean = mean(SEVERIDADE),\n    sev_sd = sd(SEVERIDADE),\n    n = n()\n  ) %>%\n  mutate(\n    sev_CI_lower = sev_mean - qt(0.975, df = n-1) * sev_sd/sqrt(n),\n    sev_CI_upper = sev_mean + qt(0.975, df = n-1) * sev_sd/sqrt(n)\n  )\n\nhead(PTD_2) %>% \n  kable(align = \"c\") %>% \n  kable_styling(full_width = FALSE)\n```\n\n## VERIFICAÇÃO DA INTERAÇÃO ENTRE EXPERIMENTOS\n\n```{r}\nPTD_3 <- PTD %>%\n  group_by(REPETIÇÃO, TRATAMENTO, BLOCO) %>% \n  summarise(\n    audpc = AUDPC(DAE, SEVERIDADE),\n    .groups = 'drop'\n  ) %>% \n  mutate(\n    REPETIÇÃO = as.factor(REPETIÇÃO),\n    TRATAMENTO = as.factor(TRATAMENTO),\n    BLOCO = as.factor(BLOCO)\n  )\n\nhead(PTD_3) %>% \n  kable(align = \"c\") %>% \n  kable_styling(full_width = FALSE)\n```\n\n## Interação\n\n```{r}\nmodelo_interacao <- lm(audpc ~ TRATAMENTO * REPETIÇÃO + BLOCO,\n                       data = PTD_3)\n\nanova_interacao <- anova(modelo_interacao)\nkable(anova_interacao) %>% \n  kable_styling(full_width = FALSE)\n\nif (anova_interacao[\"TRATAMENTO:REPETIÇÃO\", \"Pr(>F)\"] < 0.05) {\n  message(\"Interação significativa encontrada. Analisando experimentos separadamente.\")\n} else {\n  message(\"Nenhuma interação significativa. Pode-se analisar os dados combinados.\")\n}\n```\n\n## ANÁLISE INDIVIDUAL PARA CADA EXPERIMENTO\n\n```{r}\nanalisar_experimento <- function(dados_experimento, exp_id) {\n  \n  message(paste(\"\\nAnálise para o Experimento\", exp_id, \"\\n\"))\n  \n  modelo <- lm(audpc ~ TRATAMENTO + BLOCO,\n               data = dados_experimento)\n  \n  cat(\"\\nVerificação de pressupostos:\\n\")\n  teste_normalidade <- check_normality(modelo)\n  print(teste_normalidade)\n  \n  p_heteroced <- check_heteroscedasticity(modelo)\n  cat(\"Teste de heterocedasticidade - p-value:\", p_heteroced, \"\\n\")\n  \n  par(mfrow = c(1, 2))\n  plot(residuals(modelo) ~ fitted(modelo), main = \"Resíduos vs Ajustados\")\n  abline(h = 0, col = \"red\")\n  qqnorm(residuals(modelo), main = \"Q-Q Plot dos Resíduos\")\n  qqline(residuals(modelo), col = \"red\")\n  par(mfrow = c(1, 1))\n  \n  if (p_heteroced < 0.05) {\n    message(\"Heterocedasticidade detectada (p = \", round(p_heteroced, 3), \"). Aplicando transformação logarítmica.\")\n    modelo <- lm(log(audpc) ~ TRATAMENTO + BLOCO,\n                 data = dados_experimento)\n    \n    cat(\"\\nVerificação após transformação:\\n\")\n    print(check_normality(modelo))\n    p_heteroced_pos <- check_heteroscedasticity(modelo)\n    cat(\"Teste de heterocedasticidade após transformação - p-value:\", p_heteroced_pos, \"\\n\")\n  }\n  \n  cat(\"\\nTabela ANOVA:\\n\")\n  anova_result <- anova(modelo)\n  print(anova_result)\n  \n  medias <- emmeans(modelo, ~ TRATAMENTO, type = \"response\")\n  \n  cld_result <- cld(medias,\n                    Letters = letters,\n                    adjust = \"tukey\")\n  \n  cv <- agricolae::cv.model(modelo) %>% round(2)\n  \n  list(\n    modelo = modelo,\n    anova = anova_result,\n    medias = medias,\n    cld = cld_result,\n    cv = cv\n  )\n}\n\nresultados_exp1 <- analisar_experimento(filter(PTD_3, REPETIÇÃO == 1), 1)\nresultados_exp2 <- analisar_experimento(filter(PTD_3, REPETIÇÃO == 2), 2)\n\n```\n\n## TABELA RESUMO DOS RESULTADOS\n\n```{r}\nextrair_dados_cld <- function(cld_obj) {\n  df <- as.data.frame(cld_obj)\n  \n  tratamento <- if (\"TRATAMENTO\" %in% names(df)) {\n    as.character(df$TRATAMENTO)\n  } else if (\"treatment\" %in% names(df)) {\n    as.character(df$treatment)\n  } else if (\"trt\" %in% names(df)) {\n    as.character(df$trt)\n  } else {\n    as.character(rownames(df))\n  }\n  \n  response <- if (\"response\" %in% names(df)) {\n    df$response\n  } else if (\"emmean\" %in% names(df)) {\n    df$emmean\n  } else if (\"prob\" %in% names(df)) {\n    df$prob\n  } else {\n    rep(NA, nrow(df))\n  }\n  \n  group <- if (\".group\" %in% names(df)) {\n    df$.group\n  } else if (\"group\" %in% names(df)) {\n    df$group\n  } else {\n    rep(\"\", nrow(df))\n  }\n  \n  data.frame(\n    TRATAMENTO = tratamento,\n    response = as.numeric(response),\n    .group = as.character(group),\n    stringsAsFactors = FALSE\n  )\n}\n\ncriar_tabela_final <- function() {\n  dados_exp1 <- extrair_dados_cld(resultados_exp1$cld) %>% \n    mutate(Experimento = \"1\",\n           response = round(response, 2))\n  \n  dados_exp2 <- extrair_dados_cld(resultados_exp2$cld) %>% \n    mutate(Experimento = \"2\",\n           response = round(response, 2))\n  \n  tabela <- bind_rows(dados_exp1, dados_exp2) %>% \n    pivot_wider(\n      names_from = Experimento,\n      values_from = c(response, .group),\n      names_glue = \"Exp_{Experimento}_{.value}\"\n    )\n  \n  linha_cv <- data.frame(\n    TRATAMENTO = \"CV (%)\",\n    Exp_1_response = resultados_exp1$cv,\n    Exp_2_response = resultados_exp2$cv,\n    Exp_1_.group = \"\",\n    Exp_2_.group = \"\",\n    stringsAsFactors = FALSE\n  )\n  \n  names(linha_cv) <- names(tabela)\n  \n  tabela_final <- bind_rows(tabela, linha_cv)\n  \n  colnames(tabela_final) <- c(\"Tratamento\", \n                              \"AACPD Exp 1\", \"Grupo Exp 1\", \n                              \"AACPD Exp 2\", \"Grupo Exp 2\")\n  \n  return(tabela_final)\n}\n\ntabela_final <- criar_tabela_final()\n\nkable(tabela_final, align = \"c\") %>% \n  kable_styling(full_width = FALSE) %>% \n  add_header_above(c(\" \" = 1, \"Experimento 1\" = 2, \"Experimento 2\" = 2)) %>% \n  row_spec(nrow(tabela_final), bold = TRUE) %>% \n  footnote(general = \"Médias seguidas pela mesma letra não diferem entre si pelo teste de Tukey (p < 0.05)\")\n\n```\n\n## VISUALIZAÇÃO GRÁFICA DOS RESULTADOS\n\n```{r}\nggplot(PTD_3, aes(x = TRATAMENTO, y = audpc, fill = REPETIÇÃO)) +\n  geom_boxplot(alpha = 0.7) +\n  stat_summary(\n    fun = mean, geom = \"point\", \n    shape = 18, size = 3, color = \"red\",\n    position = position_dodge(width = 0.75)\n  ) +\n  labs(\n    x = \"Tratamentos\",\n    y = \"Área Abaixo da Curva de Progresso da Doença (AACPD)\",\n    fill = \"Experimento\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"top\"\n  ) +\n  scale_fill_manual(\n    values = c(\"#1f78b4\", \"#33a02c\"),\n    labels = c(\"Experimento 1\", \"Experimento 2\")\n  )\n\nggplot(PTD_2, aes(x = DAE, y = sev_mean, color = TRATAMENTO)) +\n  geom_line(size = 1) +\n  geom_point(size = 2) +\n  geom_errorbar(\n    aes(ymin = sev_CI_lower, ymax = sev_CI_upper),\n    width = 0.5\n  ) +\n  facet_wrap(~REPETIÇÃO, \n             labeller = labeller(\n               REPETIÇÃO = c(\"1\" = \"Experimento 1\", \"2\" = \"Experimento 2\")\n             )) +\n  labs(\n    x = \"Dias Após a Inoculação (DAI)\",\n    y = \"Severidade da Doença (Proporção)\",\n    color = \"Tratamento\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    legend.position = \"bottom\",\n    strip.text = element_text(face = \"bold\", size = 12)\n  ) +\n  scale_color_brewer(palette = \"Set1\")\n```\n","srcMarkdownNoYaml":"\n\n# CARREGAMENTO DE PACOTES\n\n```{r}\n\nlibrary(tidyverse)\nlibrary(drc)\nlibrary(gsheet)\nlibrary(kableExtra)\nlibrary(DT)\nlibrary(leaflet)\nlibrary(patchwork)\nlibrary(performance)\nlibrary(emmeans)\nlibrary(DHARMa)\nlibrary(multcomp)\nlibrary(epifitter)\nlibrary(lme4)\nlibrary(agricolae)\nlibrary(qqplotr)\n```\n\n## LOCALIZAÇÃO DOS EXPERIMENTOS\n\n### Os experimentos foram conduzidos na área experimental do Departamento de Fitopatologia da Universidade Federal de Viçosa, município de Viçosa, Minas Gerais, Brasil, localizada na região sudeste do estado de Minas Gerais (20º44'44''S, 42º50'59''O e 661 m acima do nível do mar). O primeiro experimento foi conduzido de novembro de 2023 a março de 2024 (Experimento 1; E1) e o segundo experimento de dezembro de 2023 a abril de 2024 (Experimento 2; E2).\n\n```{r}\nleaflet() %>%\n  addTiles() %>% \n  setView(lng = -42.8497, lat = -20.7453, zoom = 16) %>% \n  addMarkers(lng = -42.8497, lat = -20.7453, \n             popup = \"Localização do experimento\")\n```\n\n## ANÁLISE DE GERMINAÇÃO DE UREDÓSPOROS (GU)\n\n### A germinação de uredósporos (*GU*) é um bioensaio crítico para avaliar a sensibilidade de patógenos a tratamentos. Nesta seção, modelamos a curva dose-resposta usando um modelo log-logístico, calculamos a inibição percentual em relação ao controle e determinamos a EC50 (dose para 50% de inibição). Os resultados são apresentados em gráficos com intervalos de confiança e tabelas sumarizadas, destacando a eficácia do tratamento em suprimir a germinação.\n\n```{r}\nGU <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1zEsVt_nnmydEUBJjkyMrOLHEu6pXeM-SmwTXyEoNbmg/edit?gid=0#gid=0\")\n\nGU <- GU %>% \n  mutate(\n    REPETICAO = as.factor(REPETICAO),\n    DOSE = as.numeric(DOSE)\n  )\n\nhead(GU) %>% \n  kable(align = \"c\") %>% \n  kable_styling(full_width = FALSE)\n\ncontrole <- GU %>% \n  filter(DOSE == 0) %>% \n  summarise(mean_controle = mean(TAXA_DE_GERMINAÇÃO)) %>% \n  pull()\n\nGU2 <- GU %>% \n  group_by(DOSE) %>%\n  summarise(\n    mean_germ = mean(TAXA_DE_GERMINAÇÃO),\n    sd_germ = sd(TAXA_DE_GERMINAÇÃO),\n    n = n()\n  ) %>% \n  mutate(\n    inib = ((controle - mean_germ)/controle)*100,\n    CI_lower = mean_germ - qt(0.975, df = n-1) * sd_germ/sqrt(n),\n    CI_upper = mean_germ + qt(0.975, df = n-1) * sd_germ/sqrt(n)\n  ) %>% \n  round(digits = 2)\n\nhead(GU2) %>% \n  kable(align = \"c\") %>% \n  kable_styling(full_width = FALSE)\n```\n\n## MODELAGEM DA CURVA DOSE-RESPOSTA\n\nA modelagem da curva dose-resposta é essencial para quantificar a relação entre a concentração do tratamento e seu efeito na germinação de uredósporos. Nesta análise:\n\nUtilizamos um modelo não linear (*drm* com função *W1.4*) para estimar parâmetros como:\n\n-   **E\\<sub\\>max\\</sub\\>**: Máxima inibição observada.\n\n-   **EC50**: Dose para 50% do efeito (com IC 95%).\n\n-   **Inclinação da curva**: Sensibilidade do patógeno a variações de dose.\\\n    A validação do modelo incluiu análise de resíduos e teste de normalidade, garantindo robustez nas estimativas.\n\n```{r}\nEC <- drm(\n  mean_germ ~ DOSE,\n  data = GU2,\n  fct = W1.4()\n)\n\nsummary(EC)\n\npar(mfrow = c(1, 2))\nplot(residuals(EC) ~ fitted(EC), main = \"Resíduos vs Ajustados\")\nabline(h = 0, col = \"red\")\nqqnorm(residuals(EC), main = \"Q-Q Plot dos Resíduos\")\nqqline(residuals(EC), col = \"red\")\n\nEC50_result <- ED(EC, 50, interval = \"delta\")\ncat(paste(\"EC50 =\", round(EC50_result[1], 2),\n          \"(\", round(EC50_result[3], 2), \"-\", round(EC50_result[4], 2), \")\"))\n```\n\n## VISUALIZAÇÃO DA CURVA DOSE-RESPOSTA\n\n```{r}\nplot_curva <- ggplot(data = GU2, aes(x = DOSE)) +\n  geom_point(aes(y = mean_germ), size = 3) +\n  geom_errorbar(aes(ymin = CI_lower, ymax = CI_upper), width = 0.2) +\n  geom_line(aes(y = fitted(EC)), color = \"blue\") +\n  geom_hline(yintercept = 50, linetype = \"dashed\", color = \"red\") +\n  annotate(\"text\", \n           x = max(GU2$DOSE), \n           y = 55,\n           label = paste0(\"EC50 = \", round(EC50_result[1], 2), \n                          \" (\", round(EC50_result[3], 2), \"-\", \n                          round(EC50_result[4], 2), \")\"), \n           hjust = 1, \n           color = \"red\") +\n  labs(x = expression(\"Dose (ml L\"^-1~\")\"), \n       y = \"Germinação média (%)\",\n       title = \"Curva Dose-Resposta\") +\n  theme_minimal()\n\nprint(plot_curva)\n\n```\n\n## CÁLCULO DA ÁREA ABAIXO DA CURVA (AACPD)\n\n```{r}\nPTD <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1zEsVt_nnmydEUBJjkyMrOLHEu6pXeM-SmwTXyEoNbmg/edit?gid=1680501439#gid=1680501439\")\n\nPTD <- PTD %>% \n  mutate(\n    SEVERIDADE = as.numeric(str_replace(SEVERIDADE, \",\", \".\")) / 100,\n    REPETIÇÃO = as.factor(REPETIÇÃO),\n    BLOCO = as.factor(BLOCO),\n    TRATAMENTO = as.factor(TRATAMENTO)\n  )\n\nniveis_tratamento <- c(\"Control\", \"3 x F\", \"3 x IRStimulus\",\n                       \"F, IRStimulus, IRStimulus\", \n                       \"IRStimulus, F, IRStimulus\", \n                       \"IRStimulus+F, F,F\")\n\nlevels(PTD$TRATAMENTO) <- niveis_tratamento\n\nPTD_2 <- PTD %>%\n  group_by(REPETIÇÃO, TRATAMENTO, DAE) %>% \n  summarise(\n    sev_mean = mean(SEVERIDADE),\n    sev_sd = sd(SEVERIDADE),\n    n = n()\n  ) %>%\n  mutate(\n    sev_CI_lower = sev_mean - qt(0.975, df = n-1) * sev_sd/sqrt(n),\n    sev_CI_upper = sev_mean + qt(0.975, df = n-1) * sev_sd/sqrt(n)\n  )\n\nhead(PTD_2) %>% \n  kable(align = \"c\") %>% \n  kable_styling(full_width = FALSE)\n```\n\n## VERIFICAÇÃO DA INTERAÇÃO ENTRE EXPERIMENTOS\n\n```{r}\nPTD_3 <- PTD %>%\n  group_by(REPETIÇÃO, TRATAMENTO, BLOCO) %>% \n  summarise(\n    audpc = AUDPC(DAE, SEVERIDADE),\n    .groups = 'drop'\n  ) %>% \n  mutate(\n    REPETIÇÃO = as.factor(REPETIÇÃO),\n    TRATAMENTO = as.factor(TRATAMENTO),\n    BLOCO = as.factor(BLOCO)\n  )\n\nhead(PTD_3) %>% \n  kable(align = \"c\") %>% \n  kable_styling(full_width = FALSE)\n```\n\n## Interação\n\n```{r}\nmodelo_interacao <- lm(audpc ~ TRATAMENTO * REPETIÇÃO + BLOCO,\n                       data = PTD_3)\n\nanova_interacao <- anova(modelo_interacao)\nkable(anova_interacao) %>% \n  kable_styling(full_width = FALSE)\n\nif (anova_interacao[\"TRATAMENTO:REPETIÇÃO\", \"Pr(>F)\"] < 0.05) {\n  message(\"Interação significativa encontrada. Analisando experimentos separadamente.\")\n} else {\n  message(\"Nenhuma interação significativa. Pode-se analisar os dados combinados.\")\n}\n```\n\n## ANÁLISE INDIVIDUAL PARA CADA EXPERIMENTO\n\n```{r}\nanalisar_experimento <- function(dados_experimento, exp_id) {\n  \n  message(paste(\"\\nAnálise para o Experimento\", exp_id, \"\\n\"))\n  \n  modelo <- lm(audpc ~ TRATAMENTO + BLOCO,\n               data = dados_experimento)\n  \n  cat(\"\\nVerificação de pressupostos:\\n\")\n  teste_normalidade <- check_normality(modelo)\n  print(teste_normalidade)\n  \n  p_heteroced <- check_heteroscedasticity(modelo)\n  cat(\"Teste de heterocedasticidade - p-value:\", p_heteroced, \"\\n\")\n  \n  par(mfrow = c(1, 2))\n  plot(residuals(modelo) ~ fitted(modelo), main = \"Resíduos vs Ajustados\")\n  abline(h = 0, col = \"red\")\n  qqnorm(residuals(modelo), main = \"Q-Q Plot dos Resíduos\")\n  qqline(residuals(modelo), col = \"red\")\n  par(mfrow = c(1, 1))\n  \n  if (p_heteroced < 0.05) {\n    message(\"Heterocedasticidade detectada (p = \", round(p_heteroced, 3), \"). Aplicando transformação logarítmica.\")\n    modelo <- lm(log(audpc) ~ TRATAMENTO + BLOCO,\n                 data = dados_experimento)\n    \n    cat(\"\\nVerificação após transformação:\\n\")\n    print(check_normality(modelo))\n    p_heteroced_pos <- check_heteroscedasticity(modelo)\n    cat(\"Teste de heterocedasticidade após transformação - p-value:\", p_heteroced_pos, \"\\n\")\n  }\n  \n  cat(\"\\nTabela ANOVA:\\n\")\n  anova_result <- anova(modelo)\n  print(anova_result)\n  \n  medias <- emmeans(modelo, ~ TRATAMENTO, type = \"response\")\n  \n  cld_result <- cld(medias,\n                    Letters = letters,\n                    adjust = \"tukey\")\n  \n  cv <- agricolae::cv.model(modelo) %>% round(2)\n  \n  list(\n    modelo = modelo,\n    anova = anova_result,\n    medias = medias,\n    cld = cld_result,\n    cv = cv\n  )\n}\n\nresultados_exp1 <- analisar_experimento(filter(PTD_3, REPETIÇÃO == 1), 1)\nresultados_exp2 <- analisar_experimento(filter(PTD_3, REPETIÇÃO == 2), 2)\n\n```\n\n## TABELA RESUMO DOS RESULTADOS\n\n```{r}\nextrair_dados_cld <- function(cld_obj) {\n  df <- as.data.frame(cld_obj)\n  \n  tratamento <- if (\"TRATAMENTO\" %in% names(df)) {\n    as.character(df$TRATAMENTO)\n  } else if (\"treatment\" %in% names(df)) {\n    as.character(df$treatment)\n  } else if (\"trt\" %in% names(df)) {\n    as.character(df$trt)\n  } else {\n    as.character(rownames(df))\n  }\n  \n  response <- if (\"response\" %in% names(df)) {\n    df$response\n  } else if (\"emmean\" %in% names(df)) {\n    df$emmean\n  } else if (\"prob\" %in% names(df)) {\n    df$prob\n  } else {\n    rep(NA, nrow(df))\n  }\n  \n  group <- if (\".group\" %in% names(df)) {\n    df$.group\n  } else if (\"group\" %in% names(df)) {\n    df$group\n  } else {\n    rep(\"\", nrow(df))\n  }\n  \n  data.frame(\n    TRATAMENTO = tratamento,\n    response = as.numeric(response),\n    .group = as.character(group),\n    stringsAsFactors = FALSE\n  )\n}\n\ncriar_tabela_final <- function() {\n  dados_exp1 <- extrair_dados_cld(resultados_exp1$cld) %>% \n    mutate(Experimento = \"1\",\n           response = round(response, 2))\n  \n  dados_exp2 <- extrair_dados_cld(resultados_exp2$cld) %>% \n    mutate(Experimento = \"2\",\n           response = round(response, 2))\n  \n  tabela <- bind_rows(dados_exp1, dados_exp2) %>% \n    pivot_wider(\n      names_from = Experimento,\n      values_from = c(response, .group),\n      names_glue = \"Exp_{Experimento}_{.value}\"\n    )\n  \n  linha_cv <- data.frame(\n    TRATAMENTO = \"CV (%)\",\n    Exp_1_response = resultados_exp1$cv,\n    Exp_2_response = resultados_exp2$cv,\n    Exp_1_.group = \"\",\n    Exp_2_.group = \"\",\n    stringsAsFactors = FALSE\n  )\n  \n  names(linha_cv) <- names(tabela)\n  \n  tabela_final <- bind_rows(tabela, linha_cv)\n  \n  colnames(tabela_final) <- c(\"Tratamento\", \n                              \"AACPD Exp 1\", \"Grupo Exp 1\", \n                              \"AACPD Exp 2\", \"Grupo Exp 2\")\n  \n  return(tabela_final)\n}\n\ntabela_final <- criar_tabela_final()\n\nkable(tabela_final, align = \"c\") %>% \n  kable_styling(full_width = FALSE) %>% \n  add_header_above(c(\" \" = 1, \"Experimento 1\" = 2, \"Experimento 2\" = 2)) %>% \n  row_spec(nrow(tabela_final), bold = TRUE) %>% \n  footnote(general = \"Médias seguidas pela mesma letra não diferem entre si pelo teste de Tukey (p < 0.05)\")\n\n```\n\n## VISUALIZAÇÃO GRÁFICA DOS RESULTADOS\n\n```{r}\nggplot(PTD_3, aes(x = TRATAMENTO, y = audpc, fill = REPETIÇÃO)) +\n  geom_boxplot(alpha = 0.7) +\n  stat_summary(\n    fun = mean, geom = \"point\", \n    shape = 18, size = 3, color = \"red\",\n    position = position_dodge(width = 0.75)\n  ) +\n  labs(\n    x = \"Tratamentos\",\n    y = \"Área Abaixo da Curva de Progresso da Doença (AACPD)\",\n    fill = \"Experimento\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"top\"\n  ) +\n  scale_fill_manual(\n    values = c(\"#1f78b4\", \"#33a02c\"),\n    labels = c(\"Experimento 1\", \"Experimento 2\")\n  )\n\nggplot(PTD_2, aes(x = DAE, y = sev_mean, color = TRATAMENTO)) +\n  geom_line(size = 1) +\n  geom_point(size = 2) +\n  geom_errorbar(\n    aes(ymin = sev_CI_lower, ymax = sev_CI_upper),\n    width = 0.5\n  ) +\n  facet_wrap(~REPETIÇÃO, \n             labeller = labeller(\n               REPETIÇÃO = c(\"1\" = \"Experimento 1\", \"2\" = \"Experimento 2\")\n             )) +\n  labs(\n    x = \"Dias Após a Inoculação (DAI)\",\n    y = \"Severidade da Doença (Proporção)\",\n    color = \"Tratamento\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    legend.position = \"bottom\",\n    strip.text = element_text(face = \"bold\", size = 12)\n  ) +\n  scale_color_brewer(palette = \"Set1\")\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"index (1).html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","editor":"visual","theme":{"light":"flatly","dark":"darkly"}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":[]}